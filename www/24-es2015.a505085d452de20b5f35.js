(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"F/Pw":function(l,n,t){"use strict";t.r(n);var u=t("8Y7J"),e=t("mrSG"),i=t("34Y5"),r=t("ZZ/e"),s=t("kVqo"),o=t("2Rin");class b{constructor(l,n,t,u,r,s){this.storage=l,this.modalCtrl=n,this.navCtrl=t,this.utilService=u,this.activeRoute=r,this.ordersService=s,this.orders=[],this.selected=0,this.page=1,this.last=!1,this.activeRoute.queryParams.subscribe(l=>{void 0!==l.selectedTab&&(this.selected=l.selectedTab)}),this.storage.get("user").then(l=>e.b(this,void 0,void 0,(function*(){null==l?((yield this.modalCtrl.create({component:i.a})).present(),this.navCtrl.navigateRoot("/tabs/index")):(this.userId=l._id,this.getOrderList(this.selected))})))}ngOnInit(){}segmentChanged(l){this.selected=l.detail.value,this.last=!1,this.page=1,void 0!==this.infiniteScroll&&(this.infiniteScroll.target.disabled=!1),this.getOrderList(l.detail.value)}getOrderList(l){this.ordersService.httpGetOrderById(this.userId).subscribe(n=>{0===n.code&&(this.orders=n.orders,0==l?this.orders=this.orders.filter(l=>0==l.status):1==l?this.orders=this.orders.filter(l=>1==l.status):2==l?this.orders=this.orders.filter(l=>2==l.status):3==l&&(this.orders=this.orders.filter(l=>1e3!=l.status)),this.orders.map(l=>{l.products=JSON.parse(l.products),0===l.status?l.orderStatusText="\u5f85\u652f\u4ed8":1===l.status?l.orderStatusText="\u5df1\u4ed8\u6b3e\uff0c\u5f85\u53d1\u8d27":2===l.status?l.orderStatusText="\u5df1\u53d1\u8d27":1e3===l.status&&(l.orderStatusText="\u5df1\u5220\u9664")}))})}goToPay(l){this.storage.set("orders",l.products),this.storage.set("sn",l.sn),this.storage.set("no",l._id),this.navCtrl.navigateForward("/pay-order")}delOrder(l){this.utilService.alert("\u786e\u8ba4\u5220\u9664\u8be5\u8ba2\u5355\uff1f",n=>{this.ordersService.httpDelOrder(l).subscribe(l=>{0===l.code?this.getOrderList(this.selected):(this.getOrderList(this.selected),this.utilService.showToast(l.msg))})})}doInfinite(l){return e.b(this,void 0,void 0,(function*(){this.page++,this.infiniteScroll=l;const n=yield this.utilService.showLoading();this.ordersService.httpGetOrderById(this.userId,this.page).subscribe(t=>{0===t.code&&(this.orders=this.orders.concat(t.orders),this.orders.map(l=>{"string"==typeof l.products&&(l.products=JSON.parse(l.products)),0===l.status?l.orderStatusText="\u5f85\u652f\u4ed8":1===l.status?l.orderStatusText="\u5df1\u4ed8\u6b3e\uff0c\u5f85\u53d1\u8d27":2===l.status?l.orderStatusText="\u5df1\u53d1\u8d27":1e3===l.status&&(l.orderStatusText="\u5df1\u5220\u9664")}),this.last=t.isLast,0==this.selected?this.orders=this.orders.filter(l=>0==l.status):1==this.selected?this.orders=this.orders.filter(l=>1==l.status):2==this.selected?this.orders=this.orders.filter(l=>2==l.status):3==this.selected&&(this.orders=this.orders.filter(l=>1e3!=l.status)),l.target.complete(),this.last&&(l.target.disabled=!0)),n.dismiss()},l=>{this.errorMessage=l,this.utilService.showToast(l)})}))}}class c{}var a=t("pMnS"),d=t("oBZk"),h=t("SVse"),p=t("iInd"),g=t("s7LF"),x=t("xgBC"),m=u.pb({encapsulation:0,styles:[[".order-item[_ngcontent-%COMP%]{color:#555;font-size:14px;margin-bottom:15px}.header-item[_ngcontent-%COMP%], .order-footer[_ngcontent-%COMP%]{color:#555;font-size:14px}.header-item[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .order-footer[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:14px}.order-footer[_ngcontent-%COMP%]{--border-color:#f2f2f2}.list-item[_ngcontent-%COMP%]{padding:8px 0}.date[_ngcontent-%COMP%]{color:#999}.product-list[_ngcontent-%COMP%]{margin-bottom:0}.product-name[_ngcontent-%COMP%]{font-size:13px;line-height:20px;font-weight:400}.price-box[_ngcontent-%COMP%]{font-size:12px;color:#999}.price-box[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:12px}"]],data:{}});function f(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,1,"div",[["class","no-data"]],null,null,null,null,null)),(l()(),u.Jb(-1,null,[" \u6ca1\u6709\u4efb\u4f55\u8ba2\u5355\uff5e "]))],null,null)}function v(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,22,"ion-item",[["class","list-item"],["lines","none"]],null,null,null,d.eb,d.s)),u.qb(1,49152,null,0,r.I,[u.h,u.k,u.x],{lines:[0,"lines"]},null),(l()(),u.rb(2,0,null,0,2,"ion-thumbnail",[["item-start",""]],null,null,null,d.vb,d.J)),u.qb(3,49152,null,0,r.Ab,[u.h,u.k,u.x],null,null),(l()(),u.rb(4,0,null,0,0,"img",[],[[8,"src",4]],null,null,null,null)),(l()(),u.rb(5,0,null,0,17,"div",[["class","price-box"],["style","flex: 1;"]],null,null,null,null,null)),(l()(),u.rb(6,0,null,null,1,"h2",[["class","product-name"]],null,null,null,null,null)),(l()(),u.Jb(7,null,["",""])),(l()(),u.rb(8,0,null,null,14,"ion-row",[],null,null,null,d.jb,d.x)),u.qb(9,49152,null,0,r.kb,[u.h,u.k,u.x],null,null),(l()(),u.rb(10,0,null,0,4,"ion-col",[],null,null,null,d.T,d.h)),u.qb(11,49152,null,0,r.u,[u.h,u.k,u.x],null,null),(l()(),u.rb(12,0,null,0,2,"p",[["text-right",""]],null,null,null,null,null)),u.qb(13,16384,null,0,r.d,[u.k],null,null),(l()(),u.Jb(14,null,["x ",""])),(l()(),u.rb(15,0,null,0,7,"ion-col",[["col-2",""]],null,null,null,d.T,d.h)),u.qb(16,49152,null,0,r.u,[u.h,u.k,u.x],null,null),(l()(),u.rb(17,0,null,0,5,"p",[["text-right",""]],null,null,null,null,null)),u.qb(18,16384,null,0,r.d,[u.k],null,null),(l()(),u.Jb(-1,null,["\uffe5"])),(l()(),u.rb(20,0,null,null,1,"b",[["class","red"]],null,null,null,null,null)),(l()(),u.Jb(21,null,["",""])),(l()(),u.Jb(-1,null,["\u5143"]))],(function(l,n){l(n,1,0,"none")}),(function(l,n){l(n,4,0,u.vb(1,"",n.context.$implicit.product.banner.path,"")),l(n,7,0,n.context.$implicit.product.name),l(n,14,0,n.context.$implicit.num?n.context.$implicit.num:0),l(n,21,0,((n.context.$implicit.num?n.context.$implicit.num:0)*n.context.$implicit.product.price).toFixed(2))}))}function k(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,3,"ion-list",[["class","product-list"],["lines","none"]],null,null,null,d.gb,d.u)),u.qb(1,49152,null,0,r.P,[u.h,u.k,u.x],{lines:[0,"lines"]},null),(l()(),u.gb(16777216,null,0,1,null,v)),u.qb(3,278528,null,0,h.i,[u.M,u.J,u.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){l(n,1,0,"none"),l(n,3,0,n.parent.context.$implicit.products)}),null)}function q(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,2,"ion-button",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.goToPay(l.parent.context.$implicit)&&u),u}),d.Q,d.e)),u.qb(1,49152,null,0,r.l,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u7ee7\u7eed\u652f\u4ed8"]))],null,null)}function O(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,29,"div",[["class","order-item"]],null,null,null,null,null)),(l()(),u.rb(1,0,null,null,7,"ion-item",[["class","header-item"],["lines","none"]],null,null,null,d.eb,d.s)),u.qb(2,49152,null,0,r.I,[u.h,u.k,u.x],{lines:[0,"lines"]},null),(l()(),u.rb(3,0,null,0,2,"ion-label",[],null,null,null,d.fb,d.t)),u.qb(4,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(5,0,["",""])),(l()(),u.rb(6,0,null,0,2,"div",[["class","date"],["item-end",""]],null,null,null,null,null)),(l()(),u.Jb(7,null,["",""])),u.Fb(8,2),(l()(),u.gb(16777216,null,null,1,null,k)),u.qb(10,16384,null,0,h.j,[u.M,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.rb(11,0,null,null,9,"ion-item",[["class","order-footer"],["lines","full"]],null,null,null,d.eb,d.s)),u.qb(12,49152,null,0,r.I,[u.h,u.k,u.x],{lines:[0,"lines"]},null),(l()(),u.rb(13,0,null,0,2,"ion-label",[["class","status"]],null,null,null,d.fb,d.t)),u.qb(14,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(15,0,["",""])),(l()(),u.rb(16,0,null,0,4,"div",[["class","sum"],["item-end",""]],null,null,null,null,null)),(l()(),u.Jb(-1,null,["\u603b\u4ef7 "])),(l()(),u.rb(18,0,null,null,1,"b",[["class","red"]],null,null,null,null,null)),(l()(),u.Jb(19,null,["\uffe5",""])),(l()(),u.Jb(-1,null,["\u5143"])),(l()(),u.rb(21,0,null,null,8,"ion-toolbar",[],null,null,null,d.xb,d.L)),u.qb(22,49152,null,0,r.Db,[u.h,u.k,u.x],null,null),(l()(),u.rb(23,0,null,0,6,"ion-buttons",[["slot","primary"]],null,null,null,d.R,d.f)),u.qb(24,49152,null,0,r.m,[u.h,u.k,u.x],null,null),(l()(),u.gb(16777216,null,0,1,null,q)),u.qb(26,16384,null,0,h.j,[u.M,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.rb(27,0,null,0,2,"ion-button",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.delOrder(l.context.$implicit._id)&&u),u}),d.Q,d.e)),u.qb(28,49152,null,0,r.l,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u5220\u9664"]))],(function(l,n){var t=n.component;l(n,2,0,"none"),l(n,10,0,t.orders.length>0),l(n,12,0,"full"),l(n,26,0,0==n.context.$implicit.status)}),(function(l,n){l(n,5,0,n.context.$implicit.sn);var t=u.Kb(n,7,0,l(n,8,0,u.Db(n.parent,0),n.context.$implicit.createdAt,"yyyy-MM-dd HH:mm:ss"));l(n,7,0,t),l(n,15,0,n.context.$implicit.orderStatusText);var e=n.context.$implicit.sumPrice.toFixed(2);l(n,19,0,e)}))}function J(l){return u.Lb(0,[u.Eb(0,h.d,[u.s]),(l()(),u.rb(1,0,null,null,18,"ion-header",[],null,null,null,d.Z,d.n)),u.qb(2,49152,null,0,r.C,[u.h,u.k,u.x],null,null),(l()(),u.rb(3,0,null,0,16,"ion-toolbar",[["class","toolbar"]],null,null,null,d.xb,d.L)),u.qb(4,49152,null,0,r.Db,[u.h,u.k,u.x],null,null),(l()(),u.rb(5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,d.R,d.f)),u.qb(6,49152,null,0,r.m,[u.h,u.k,u.x],null,null),(l()(),u.rb(7,0,null,0,2,"ion-back-button",[["mode","md"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==u.Db(l,9).onClick(t)&&e),e}),d.O,d.c)),u.qb(8,49152,null,0,r.h,[u.h,u.k,u.x],{mode:[0,"mode"]},null),u.qb(9,16384,null,0,r.i,[[2,r.jb],r.Jb],null,null),(l()(),u.rb(10,0,null,0,2,"ion-title",[],null,null,null,d.wb,d.K)),u.qb(11,49152,null,0,r.Bb,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u8ba2\u5355"])),(l()(),u.rb(13,0,null,0,6,"ion-buttons",[["slot","primary"]],null,null,null,d.R,d.f)),u.qb(14,49152,null,0,r.m,[u.h,u.k,u.x],null,null),(l()(),u.rb(15,0,null,0,4,"ion-button",[["class","red-right"],["routerLink","/"]],null,[[null,"click"]],(function(l,n,t){var e=!0;return"click"===n&&(e=!1!==u.Db(l,17).onClick()&&e),"click"===n&&(e=!1!==u.Db(l,18).onClick(t)&&e),e}),d.Q,d.e)),u.qb(16,49152,null,0,r.l,[u.h,u.k,u.x],null,null),u.qb(17,16384,null,0,p.n,[p.m,p.a,[8,null],u.B,u.k],{routerLink:[0,"routerLink"]},null),u.qb(18,737280,null,0,r.Mb,[h.h,r.Jb,u.k,p.m,[2,p.n]],null,null),(l()(),u.Jb(-1,0,["\u8fd4\u56de\u9996\u9875"])),(l()(),u.rb(20,0,null,null,33,"ion-content",[["class","content"]],null,null,null,d.U,d.i)),u.qb(21,49152,null,0,r.v,[u.h,u.k,u.x],null,null),(l()(),u.rb(22,0,null,0,23,"ion-segment",[],null,[[null,"ionChange"],[null,"ionBlur"]],(function(l,n,t){var e=!0,i=l.component;return"ionBlur"===n&&(e=!1!==u.Db(l,25)._handleBlurEvent(t.target)&&e),"ionChange"===n&&(e=!1!==u.Db(l,25)._handleChangeEvent(t.target)&&e),"ionChange"===n&&(e=!1!==i.segmentChanged(t)&&e),e}),d.mb,d.z)),u.Gb(5120,null,g.h,(function(l){return[l]}),[r.Nb]),u.qb(24,49152,null,0,r.mb,[u.h,u.k,u.x],{value:[0,"value"]},null),u.qb(25,16384,null,0,r.Nb,[u.k],null,null),(l()(),u.rb(26,0,null,0,4,"ion-segment-button",[["value","0"]],null,null,null,d.lb,d.A)),u.qb(27,49152,null,0,r.nb,[u.h,u.k,u.x],{value:[0,"value"]},null),(l()(),u.rb(28,0,null,0,2,"ion-label",[],null,null,null,d.fb,d.t)),u.qb(29,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u5f85\u4ed8\u6b3e"])),(l()(),u.rb(31,0,null,0,4,"ion-segment-button",[["value","1"]],null,null,null,d.lb,d.A)),u.qb(32,49152,null,0,r.nb,[u.h,u.k,u.x],{value:[0,"value"]},null),(l()(),u.rb(33,0,null,0,2,"ion-label",[],null,null,null,d.fb,d.t)),u.qb(34,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u5f85\u6536\u8d27"])),(l()(),u.rb(36,0,null,0,4,"ion-segment-button",[["value","2"]],null,null,null,d.lb,d.A)),u.qb(37,49152,null,0,r.nb,[u.h,u.k,u.x],{value:[0,"value"]},null),(l()(),u.rb(38,0,null,0,2,"ion-label",[],null,null,null,d.fb,d.t)),u.qb(39,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u5df1\u6536\u8d27"])),(l()(),u.rb(41,0,null,0,4,"ion-segment-button",[["value","3"]],null,null,null,d.lb,d.A)),u.qb(42,49152,null,0,r.nb,[u.h,u.k,u.x],{value:[0,"value"]},null),(l()(),u.rb(43,0,null,0,2,"ion-label",[],null,null,null,d.fb,d.t)),u.qb(44,49152,null,0,r.O,[u.h,u.k,u.x],null,null),(l()(),u.Jb(-1,0,["\u5168\u90e8"])),(l()(),u.gb(16777216,null,0,1,null,f)),u.qb(47,16384,null,0,h.j,[u.M,u.J],{ngIf:[0,"ngIf"]},null),(l()(),u.gb(16777216,null,0,1,null,O)),u.qb(49,278528,null,0,h.i,[u.M,u.J,u.q],{ngForOf:[0,"ngForOf"]},null),(l()(),u.rb(50,0,null,0,3,"ion-infinite-scroll",[["threshold","100px"]],null,[[null,"ionInfinite"]],(function(l,n,t){var u=!0;return"ionInfinite"===n&&(u=!1!==l.component.doInfinite(t)&&u),u}),d.cb,d.p)),u.qb(51,49152,null,0,r.F,[u.h,u.k,u.x],{threshold:[0,"threshold"]},null),(l()(),u.rb(52,0,null,0,1,"ion-infinite-scroll-content",[["loadingSpinner","bubbles"],["loadingText","\u52a0\u8f7d\u66f4\u591a\u4e2d..."]],null,null,null,d.bb,d.q)),u.qb(53,49152,null,0,r.G,[u.h,u.k,u.x],{loadingSpinner:[0,"loadingSpinner"],loadingText:[1,"loadingText"]},null)],(function(l,n){var t=n.component;l(n,8,0,"md"),l(n,17,0,"/"),l(n,18,0),l(n,24,0,u.vb(1,"",t.selected,"")),l(n,27,0,"0"),l(n,32,0,"1"),l(n,37,0,"2"),l(n,42,0,"3"),l(n,47,0,0==t.orders.length),l(n,49,0,t.orders),l(n,51,0,"100px"),l(n,53,0,"bubbles","\u52a0\u8f7d\u66f4\u591a\u4e2d...")}),null)}function C(l){return u.Lb(0,[(l()(),u.rb(0,0,null,null,1,"app-orders",[],null,null,null,J,m)),u.qb(1,114688,null,0,b,[x.b,r.Ib,r.Jb,o.a,p.a,s.a],null,null)],(function(l,n){l(n,1,0)}),null)}var S=u.nb("app-orders",b,C,{},{},[]);t.d(n,"OrdersPageModuleNgFactory",(function(){return M}));var M=u.ob(c,[],(function(l){return u.Ab([u.Bb(512,u.j,u.Z,[[8,[a.a,S]],[3,u.j],u.v]),u.Bb(4608,h.l,h.k,[u.s,[2,h.r]]),u.Bb(4608,g.p,g.p,[]),u.Bb(4608,r.b,r.b,[u.x,u.g]),u.Bb(4608,r.Ib,r.Ib,[r.b,u.j,u.p]),u.Bb(4608,r.Lb,r.Lb,[r.b,u.j,u.p]),u.Bb(1073742336,h.b,h.b,[]),u.Bb(1073742336,g.o,g.o,[]),u.Bb(1073742336,g.e,g.e,[]),u.Bb(1073742336,r.Fb,r.Fb,[]),u.Bb(1073742336,p.o,p.o,[[2,p.t],[2,p.m]]),u.Bb(1073742336,c,c,[]),u.Bb(1024,p.k,(function(){return[[{path:"",component:b}]]}),[])])}))}}]);