(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{OXgS:function(n,l,t){"use strict";t.r(l);var u=t("CcnG"),o=t("mrSG"),i=t("ZZ/e"),e=t("S3Px"),r=t("2Rin"),s=t("34Y5"),c=t("kVqo"),a=function(){function n(n,l,t,u,o,i,e,r,s,c){var a=this;this.productService=n,this.activeRoute=l,this.productsService=t,this.navCtrl=u,this.router=o,this.events=i,this.storage=e,this.modalCtrl=r,this.orderService=s,this.utilService=c,this.proNum=0,this.isLogin=!1,this.cartNum=0,this.activeRoute.queryParams.subscribe((function(n){a.id=n.id})),this.events.subscribe("user:login",(function(n,l){a.userId=n._id,a.isLogin=l})),this.storage.get("user").then((function(n){null!==n&&(a.isLogin=!0,a.userId=n._id)})),this.events.subscribe("cart:add",(function(n){var l=0;n.map((function(n){l+=n.num})),a.cartNum=l})),this.storage.get("cart").then((function(n){if(null!==n){var l=0;n.map((function(n){l+=n.num})),a.cartNum=l}}))}return n.prototype.ngOnInit=function(){this.getProduct(),this.getProducts()},n.prototype.getProduct=function(){return o.b(this,void 0,void 0,(function(){var n,l=this;return o.e(this,(function(t){switch(t.label){case 0:return[4,this.utilService.showLoading()];case 1:return n=t.sent(),this.getProductById(this.id).subscribe((function(t){0===t.code&&(l.title=t.data.name,l.banner=t.data.banner.path,l.price=t.data.price,l.unit=t.data.unit,l.originPrice=t.data.origin_price,l.originPriceUnit=t.data.origin_price_unit,l.desc=t.data.desc,l.product=t.data),n.dismiss()}),(function(n){l.errorMsg=n})),[2]}}))}))},n.prototype.getProductById=function(n){return this.productService.getProductById(n)},n.prototype.getProducts=function(){var n=this;this.getProductList("",1).subscribe((function(l){0===l.code&&(n.products=l.data.splice(0,4))}),(function(l){n.errorMsg=l}))},n.prototype.getProductList=function(n,l){return this.productsService.getProductList(n,l)},n.prototype.goToDetail=function(n){this.id=n,this.proNum=0,this.getProduct(),this.content.scrollToTop(0),this.router.navigate(["/detail"],{queryParams:{id:n},relativeTo:this.activeRoute})},n.prototype.addToCart=function(n){return o.b(this,void 0,void 0,(function(){var l,t,u=this;return o.e(this,(function(o){switch(o.label){case 0:return this.isLogin?[3,2]:[4,this.modalCtrl.create({component:s.a})];case 1:return o.sent().present(),[2];case 2:if(void 0===this.proNum||0===this.proNum)return this.utilService.showToast("\u8bf7\u6dfb\u52a0\u8d2d\u4e70\u7684\u6570\u91cf"),[2,!1];l=[],(t={}).product=n,t.num=this.proNum,l.push(t),this.storage.get("cart").then((function(o){null==o?(u.storage.set("cart",l),u.events.publish("cart:add",l),u.utilService.showToast("\u5546\u54c1\u5df1\u7ecf\u6210\u529f\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66")):(l=o,-1!==JSON.stringify(o).indexOf(n._id)?u.utilService.showToast("\u8d2d\u7269\u8f66\u4e2d\u5df1\u7ecf\u5b58\u5728\u8be5\u5546\u54c1\uff0c\u65e0\u9700\u91cd\u590d\u6dfb\u52a0"):(l.push(t),u.storage.set("cart",l),u.events.publish("cart:add",l),u.utilService.showToast("\u5546\u54c1\u5df1\u7ecf\u6210\u529f\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66")))})),o.label=3;case 3:return[2]}}))}))},n.prototype.buyNow=function(n){return o.b(this,void 0,void 0,(function(){var l,t,u=this;return o.e(this,(function(o){switch(o.label){case 0:return this.isLogin?[3,2]:[4,this.modalCtrl.create({component:s.a})];case 1:return o.sent().present(),[2];case 2:if(void 0===this.proNum||0===this.proNum)return this.utilService.showToast("\u8bf7\u6dfb\u52a0\u8d2d\u4e70\u7684\u6570\u91cf"),[2,!1];l=[],(t={}).product=n,t.num=this.proNum,l.push(t),this.sum=n.price*this.proNum,this.orderService.httpPostOrder({products:JSON.stringify(l),sumPrice:this.sum,customer:this.userId}).subscribe((function(n){0===n.code&&(u.storage.set("orders",l),u.storage.set("sn",n.data.no),u.storage.set("no",n.data.sn),u.navCtrl.navigateForward("/pay-order"))})),o.label=3;case 3:return[2]}}))}))},n.prototype.goToCart=function(){this.navCtrl.navigateRoot("/tabs/cart")},n}(),b=function(){return function(){}}(),d=t("pMnS"),p=t("oBZk"),g=t("Ip0R"),h=t("/2TV"),f=t("W+v9"),m=t("gIcY"),v=t("qoxc"),C=t("+ylL"),P=t("ZYCi"),x=t("iw74"),k=u.rb({encapsulation:0,styles:[[".detail-header[_ngcontent-%COMP%]{position:fixed}.toolbar[_ngcontent-%COMP%]{--background:transparent;--border-color:transparent}.img-box[_ngcontent-%COMP%]{height:300px;position:relative}.pro-img[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);width:100%;max-height:100%;line-height:100%}.icon-gouwuche[_ngcontent-%COMP%]{font-size:25px}.detail_title[_ngcontent-%COMP%]{font-size:20px;padding:0 10px;margin:15px 0;color:#555;line-height:30px}.price[_ngcontent-%COMP%]{padding:0 10px;color:#555}.old-price[_ngcontent-%COMP%]{padding:0 10px;display:block;margin-bottom:10px;line-height:25px;color:#acacac}.desc[_ngcontent-%COMP%]{margin-bottom:30px}.desc[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:700;margin-bottom:10px;color:#555;padding:0 10px}.desc[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;line-height:35px;padding:0 10px;font-size:16px}.pro-num[_ngcontent-%COMP%]{--padding-start:0;margin:10px;color:#555}.pro-num[_ngcontent-%COMP%]   .num-txt[_ngcontent-%COMP%]{--color:#555;font-size:18px}.cart[_ngcontent-%COMP%]{font-size:13px;color:#555;text-align:center;padding:0 15px;position:relative}.cart[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:4px;top:0;z-index:1}.btn[_ngcontent-%COMP%]{font-size:13px;width:140px;--background:#24ad20;--background-activated:#24ad20}.top-cart[_ngcontent-%COMP%]{position:relative}.top-cart[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:absolute;right:4px;top:4px;z-index:1}"]],data:{}});function z(n){return u.Nb(0,[(n()(),u.tb(0,0,null,null,2,"ion-badge",[["class","badge"],["color","danger"]],null,null,null,p.P,p.d)),u.sb(1,49152,null,0,i.k,[u.h,u.k,u.z],{color:[0,"color"]},null),(n()(),u.Lb(2,0,["",""]))],(function(n,l){n(l,1,0,"danger")}),(function(n,l){n(l,2,0,l.component.cartNum)}))}function y(n){return u.Nb(0,[(n()(),u.tb(0,0,null,null,2,"ion-badge",[["class","badge"],["color","danger"]],null,null,null,p.P,p.d)),u.sb(1,49152,null,0,i.k,[u.h,u.k,u.z],{color:[0,"color"]},null),(n()(),u.Lb(2,0,["",""]))],(function(n,l){n(l,1,0,"danger")}),(function(n,l){n(l,2,0,l.component.cartNum)}))}function O(n){return u.Nb(0,[u.Jb(671088640,1,{content:0}),(n()(),u.tb(1,0,null,null,14,"ion-header",[["class","detail-header"]],null,null,null,p.Z,p.n)),u.sb(2,49152,null,0,i.C,[u.h,u.k,u.z],null,null),(n()(),u.tb(3,0,null,0,12,"ion-toolbar",[["class","toolbar"]],null,null,null,p.xb,p.L)),u.sb(4,49152,null,0,i.Db,[u.h,u.k,u.z],null,null),(n()(),u.tb(5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,p.R,p.f)),u.sb(6,49152,null,0,i.m,[u.h,u.k,u.z],null,null),(n()(),u.tb(7,0,null,0,2,"ion-back-button",[["class","white"],["mode","md"]],null,[[null,"click"]],(function(n,l,t){var o=!0;return"click"===l&&(o=!1!==u.Fb(n,9).onClick(t)&&o),o}),p.O,p.c)),u.sb(8,49152,null,0,i.h,[u.h,u.k,u.z],{mode:[0,"mode"]},null),u.sb(9,16384,null,0,i.i,[[2,i.jb],i.Jb],null,null),(n()(),u.tb(10,0,null,0,5,"div",[["class","top-cart"],["slot","end"]],null,null,null,null,null)),(n()(),u.tb(11,0,null,null,2,"ion-fab-button",[["size","small"]],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.goToCart()&&u),u}),p.W,p.k)),u.sb(12,49152,null,0,i.y,[u.h,u.k,u.z],{size:[0,"size"]},null),(n()(),u.tb(13,0,null,0,0,"span",[["class","iconfont icon-gouwuche"],["style","color: #fff;"]],null,null,null,null,null)),(n()(),u.ib(16777216,null,null,1,null,z)),u.sb(15,16384,null,0,g.j,[u.O,u.L],{ngIf:[0,"ngIf"]},null),(n()(),u.tb(16,0,null,null,36,"ion-content",[["fullscreen","true"]],null,null,null,p.U,p.i)),u.sb(17,49152,[[1,4]],0,i.v,[u.h,u.k,u.z],{fullscreen:[0,"fullscreen"]},null),(n()(),u.tb(18,0,null,0,1,"div",[["class","img-box"]],null,null,null,null,null)),(n()(),u.tb(19,0,null,null,0,"img",[["class","pro-img"]],[[8,"src",4],[8,"alt",0]],null,null,null,null)),(n()(),u.tb(20,0,null,0,1,"h3",[["class","detail_title"]],null,null,null,null,null)),(n()(),u.Lb(21,null,["",""])),(n()(),u.tb(22,0,null,0,4,"p",[["class","price"]],null,null,null,null,null)),(n()(),u.Lb(-1,null,["\uffe5"])),(n()(),u.tb(24,0,null,null,1,"i",[["class","red"]],null,null,null,null,null)),(n()(),u.Lb(25,null,["",""])),(n()(),u.Lb(26,null,["/",""])),(n()(),u.tb(27,0,null,0,3,"del",[["class","old-price"]],null,null,null,null,null)),(n()(),u.Lb(28,null,["\uffe5","/"])),(n()(),u.tb(29,0,null,null,1,"span",[["class","f12"]],null,null,null,null,null)),(n()(),u.Lb(30,null,["",""])),(n()(),u.tb(31,0,null,0,10,"ion-item",[["class","pro-num"],["lines","none"]],null,null,null,p.eb,p.s)),u.sb(32,49152,null,0,i.I,[u.h,u.k,u.z],{lines:[0,"lines"]},null),(n()(),u.tb(33,0,null,0,2,"ion-label",[["class","num-txt"]],null,null,null,p.fb,p.t)),u.sb(34,49152,null,0,i.O,[u.h,u.k,u.z],null,null),(n()(),u.Lb(-1,0,["\u8d2d\u4e70\u6570\u91cf\uff1a"])),(n()(),u.tb(36,0,null,0,5,"app-count",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],(function(n,l,t){var u=!0;return"ngModelChange"===l&&(u=!1!==(n.component.proNum=t)&&u),u}),h.b,h.a)),u.sb(37,49152,null,0,f.a,[],{myCount:[0,"myCount"]},null),u.Ib(1024,null,m.h,(function(n){return[n]}),[f.a]),u.sb(39,671744,null,0,m.l,[[8,null],[8,null],[8,null],[6,m.h]],{model:[0,"model"]},{update:"ngModelChange"}),u.Ib(2048,null,m.i,null,[m.l]),u.sb(41,16384,null,0,m.j,[[4,m.i]],null,null),(n()(),u.tb(42,0,null,0,4,"div",[["class","desc"]],null,null,null,null,null)),(n()(),u.tb(43,0,null,null,1,"h3",[],null,null,null,null,null)),(n()(),u.Lb(-1,null,["\u5546\u54c1\u63cf\u8ff0"])),(n()(),u.tb(45,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),u.Lb(46,null,["",""])),(n()(),u.tb(47,0,null,0,5,"app-recommended",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"productClick"]],(function(n,l,t){var u=!0;return"productClick"===l&&(u=!1!==n.component.goToDetail(t)&&u),u}),v.b,v.a)),u.sb(48,49152,null,0,C.a,[],null,{productClick:"productClick"}),u.Ib(1024,null,m.h,(function(n){return[n]}),[C.a]),u.sb(50,671744,null,0,m.l,[[8,null],[8,null],[8,null],[6,m.h]],{model:[0,"model"]},null),u.Ib(2048,null,m.i,null,[m.l]),u.sb(52,16384,null,0,m.j,[[4,m.i]],null,null),(n()(),u.tb(53,0,null,null,19,"ion-footer",[],null,null,null,p.X,p.l)),u.sb(54,49152,null,0,i.A,[u.h,u.k,u.z],null,null),(n()(),u.tb(55,0,null,0,17,"ion-toolbar",[],null,null,null,p.xb,p.L)),u.sb(56,49152,null,0,i.Db,[u.h,u.k,u.z],null,null),(n()(),u.tb(57,0,null,0,7,"ion-buttons",[["slot","start"]],null,null,null,p.R,p.f)),u.sb(58,49152,null,0,i.m,[u.h,u.k,u.z],null,null),(n()(),u.tb(59,0,null,0,5,"ion-icon-button",[["class","cart"]],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.goToCart()&&u),u}),null,null)),(n()(),u.tb(60,0,null,null,0,"span",[["class","iconfont icon-gouwuche"]],null,null,null,null,null)),(n()(),u.tb(61,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),u.Lb(-1,null,["\u8d2d\u7269\u8f66"])),(n()(),u.ib(16777216,null,null,1,null,y)),u.sb(64,16384,null,0,g.j,[u.O,u.L],{ngIf:[0,"ngIf"]},null),(n()(),u.tb(65,0,null,0,7,"ion-buttons",[["slot","end"]],null,null,null,p.R,p.f)),u.sb(66,49152,null,0,i.m,[u.h,u.k,u.z],null,null),(n()(),u.tb(67,0,null,0,2,"ion-button",[["class","btn"],["color","secondary"],["expand","full"],["fill","solid"],["size","default"]],null,[[null,"click"]],(function(n,l,t){var u=!0,o=n.component;return"click"===l&&(u=!1!==o.addToCart(o.product)&&u),u}),p.Q,p.e)),u.sb(68,49152,null,0,i.l,[u.h,u.k,u.z],{color:[0,"color"],expand:[1,"expand"],fill:[2,"fill"],size:[3,"size"]},null),(n()(),u.Lb(-1,0,["\u52a0\u5165\u8d2d\u7269\u8f66"])),(n()(),u.tb(70,0,null,0,2,"ion-button",[["class","btn"],["expand","full"],["fill","solid"],["size","default"]],null,[[null,"click"]],(function(n,l,t){var u=!0,o=n.component;return"click"===l&&(u=!1!==o.buyNow(o.product)&&u),u}),p.Q,p.e)),u.sb(71,49152,null,0,i.l,[u.h,u.k,u.z],{expand:[0,"expand"],fill:[1,"fill"],size:[2,"size"]},null),(n()(),u.Lb(-1,0,["\u7acb\u5373\u8d2d\u4e70"]))],(function(n,l){var t=l.component;n(l,8,0,"md"),n(l,12,0,"small"),n(l,15,0,t.cartNum>0),n(l,17,0,"true"),n(l,32,0,"none"),n(l,37,0,t.proNum),n(l,39,0,t.proNum),n(l,50,0,t.products),n(l,64,0,t.cartNum>0),n(l,68,0,"secondary","full","solid","default"),n(l,71,0,"full","solid","default")}),(function(n,l){var t=l.component;n(l,19,0,u.xb(1,"",t.banner,""),u.xb(1,"",t.title,"")),n(l,21,0,t.title),n(l,25,0,t.price),n(l,26,0,t.unit),n(l,28,0,t.originPrice),n(l,30,0,t.originPriceUnit),n(l,36,0,u.Fb(l,41).ngClassUntouched,u.Fb(l,41).ngClassTouched,u.Fb(l,41).ngClassPristine,u.Fb(l,41).ngClassDirty,u.Fb(l,41).ngClassValid,u.Fb(l,41).ngClassInvalid,u.Fb(l,41).ngClassPending),n(l,46,0,t.desc),n(l,47,0,u.Fb(l,52).ngClassUntouched,u.Fb(l,52).ngClassTouched,u.Fb(l,52).ngClassPristine,u.Fb(l,52).ngClassDirty,u.Fb(l,52).ngClassValid,u.Fb(l,52).ngClassInvalid,u.Fb(l,52).ngClassPending)}))}function _(n){return u.Nb(0,[(n()(),u.tb(0,0,null,null,1,"app-detail",[],null,null,null,O,k)),u.sb(1,114688,null,0,a,[e.a,P.a,e.a,i.Jb,P.m,i.e,x.b,i.Ib,c.a,r.a],null,null)],(function(n,l){n(l,1,0)}),null)}var L=u.pb("app-detail",a,_,{},{},[]),M=t("x8gb");t.d(l,"DetailPageModuleNgFactory",(function(){return N}));var N=u.qb(b,[],(function(n){return u.Cb([u.Db(512,u.j,u.bb,[[8,[d.a,L]],[3,u.j],u.x]),u.Db(4608,g.l,g.k,[u.u,[2,g.r]]),u.Db(4608,m.p,m.p,[]),u.Db(4608,i.b,i.b,[u.z,u.g]),u.Db(4608,i.Ib,i.Ib,[i.b,u.j,u.q]),u.Db(4608,i.Lb,i.Lb,[i.b,u.j,u.q]),u.Db(1073742336,g.b,g.b,[]),u.Db(1073742336,m.o,m.o,[]),u.Db(1073742336,m.e,m.e,[]),u.Db(1073742336,i.Fb,i.Fb,[]),u.Db(1073742336,P.o,P.o,[[2,P.t],[2,P.m]]),u.Db(1073742336,M.a,M.a,[]),u.Db(1073742336,b,b,[]),u.Db(1024,P.k,(function(){return[[{path:"",component:a}]]}),[])])}))}}]);